# turn into a manpage with the following command:
#
# pod2man -s 1 -u -c '' -r '' --stderr cifs.idmap.pod cifs.idmap.8
#

=head1 NAME

cifs.idmap - Userspace helper for mapping ids for Common Internet File System (CIFS)

=head1 SYNOPSIS

cifs.idmap [--help|-h] [--timeout|-t] [--version|-v] {keyid}

=head1 DESCRIPTION

This tool is part of the cifs-utils suite.

B<cifs.idmap> is a userspace helper program for the linux CIFS client
filesystem. There are a number of activities that the kernel cannot
easily do itself. This program is a callout program that does these
things for the kernel and then returns the result.

B<cifs.idmap> is generally intended to be run when the kernel calls
L<request-key(8)> for a particular key type. While it can be run
directly from the command-line, it is not generally intended to be run
that way.

This program is only called if a share is mounted with the B<cifsacl>
mount option. The kernel will only upcall to do this conversion if
that mount option is specified.

B<cifs.idmap> relies on a plugin to handle the ID mapping. If it can't
find the plugin then it will not work properly. The plugin (or a
symlink to it) must be at @pluginpath@.

In the case where B<cifs.idmap> or the plugin are unavailable, file
objects in a mounted share are assigned uid and gid of the credentials
of the process that mounted the share. It is strongly recomemended to
use mount options of uid and gid to specify a default uid and gid to
map owner SIDs and group SIDs in this situation.

=head1 OPTIONS

=over

=item B<--help|-h>

Print the usage message and exit.

=item B<--timeout|-t>

Set the expiration timer, in seconds on the key. The default is 600
seconds (10 minutes). Setting this to 0 will cause the key to never
expire.

=item B<--version|-v>

Print version number and exit.

=back

=head1 CONFIGURATION FOR KEYCTL

B<cifs.idmap> is designed to be called from the kernel via the
request-key callout program. This requires that request-key be told
where and how to call this program.  Currently B<cifs.idmap> handles a
key type of:

=over

=item B<cifs.idmap>

This keytype is for mapping a SID to either an uid or a gid

=back

To make this program useful for CIFS, you will need to set up entry for it in
L<request-key.conf(5)>. Here is an example of an entry for this key type:

    #OPERATION  TYPE           D C PROGRAM ARG1 ARG2...
    #=========  =============  = = ================================
    create      cifs.idmap     * * @sbindir@/cifs.idmap %k

See L<request-key.conf(5)> for more info on each field.

=head1 NOTES

Support for upcalls to cifs.idmap was initially introduced in the 3.0
kernel.

=head1 SEE ALSO

L<request-key.conf(5)>, L<mount.cifs(8)>

=head1 AUTHOR

Shirish Pargaonkar wrote the cifs.idmap program.

The Linux CIFS Mailing list is the preferred place to ask questions
regarding these programs.
